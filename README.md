# 2021_summer_internship

:office: <a href='https://www.geoplan.kr/'>ì£¼ì‹íšŒì‚¬ GEOPLAN</a> <br>
:date: ê¸°ê°„ : 2021.07.01 ~ 2021.08.31 <br>
:hourglass_flowing_sand: AM 09:30 ~ PM 18:30 <br>
:pencil:ë°°ìš°ê³  ìˆëŠ”ê²ƒ... Spring Framework, IoT, MariaDB, UI/UX  <br> <br>
#### 1ì¼ì°¨
* ë¶€ì„œ ë°°ì •/ íšŒì‚¬ ì†Œê°œ ë° í”„ë¡œì íŠ¸ ì•„ì´ë””ì–´ ì†Œê°œ
* Google Smart Homeê³¼ Assistantê°„ì˜ ê´€ê³„ ë° ë™ì‘ì›ë¦¬ íŒŒì•… (<a href="https://medium.com/google-developers/jdanielmyers-smart-home-eac8f87fd56e">ì°¸ê³ </a>)
* AoA(Angle of Arrival), RTLS(Real Time Location System) ê¸°ìˆ  ê³µë¶€(<a href="https://searchmobilecomputing.techtarget.com/definition/real-time-location-system-RTLS#:~:text=A%20real%2Dtime%20location%20system%20(RTLS)%20is%20one%20of,manufacturing%20plant%20to%20a%20person.">ì°¸ê³ </a>)
* Location deviceë¡œ ëŒ€ì²´í•˜ì—¬ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ì•„ì´ë””ì–´ ìƒê°
#### 2ì¼ì°¨
* cloud computing study
* ì§‘ ì™¸ë¶€ì—ì„œ ì§‘ ì•ˆì˜ cloudë¥¼ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ì§€ (ê³ ì •ipë§Œìœ¼ë¡œ ë ê¹Œ?) 
* Smart Home Study
* ë‹¤ìŒì£¼ ë°œí‘œ PPT ë§Œë“¤ê¸°
#### 3ì¼ì°¨
* ê°œë°œë¶€ì¥ë‹˜ í”¼ë“œë°±
* Hole Punching ê¸°ìˆ  ê³µë¶€ (<a href="https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=stallon72&logNo=10140690228">ì°¸ê³ </a>)
* Smart Home Map ê¸°ëŠ¥ êµ¬í˜„ (Deviceì•ˆì— ì§‘ ë„ë©´ê³¼ ê°€êµ¬ ìœ„ì¹˜ í¬í•¨ + ì‚¬ìš©ìì˜ ì‹¤ì‹œê°„ ë™ì„ )
* ê¸°ì¡´ ìŒì„± ì œì–´ì—ì„œ ìœ„ì¹˜ ê¸°ë°˜ ìë™í™”ë¡œ ëŒ€ì²´í•  ê²ƒì¸ë° ì–´ë–»ê²Œ êµ¬í˜„í•˜ë©´ ì¢‹ì„ì§€
* ë‚´ì¼ ì—°êµ¬ì›ë‹˜ UI/UX ê³„íš ì„¤ëª… 
#### 4ì¼ì°¨
* ì—°êµ¬ì›ë‹˜ UI/UX ê³„íšì•ˆ ì„¤ëª… ë° í”¼ë“œë°±
* Webhook ê¸°ìˆ  ê³µë¶€
* UWB, Beacon ê°œë… íŒŒì•…
* api ì—°ë™ ê°œë°œ 
#### 5ì¼ì°¨
* SYNC, QUERY, EXECUTE, DISCONNECT intent ì‹œ JSON ì½”ë“œ ë¶„ì„
* Google API Search
* SmartThings ì•Œì•„ë³´ê¸°
#### 6ì¼ì°¨
* SmartThings API ê³µë¶€
#### 7ì¼ì°¨
* 7ì¼ê°„ ìŠ¤í„°ë”” & ê°œë°œ ë‚´ìš© ë°œí‘œ ë° í”¼ë“œë°±(ë¶€ì¥ë‹˜, ëŒ€í‘œë‹˜, ê°œë°œíŒ€ì¥ë‹˜)
* UI/UX ìˆ˜ì •ì•ˆ í™•ì¸
* OAuth, SmartThings Rooms ë´ë³´ê¸°
* API ì—°ë™ ë° DB 
#### 8ì¼ì°¨
* Google Open API ê°€ì ¸ì™€ í™”ë©´ì— ë„ìš°ê¸°
* ë°ì´í„° DB ì €ì¥ ë° ì—°ë™
* Spring Server ê°œë°œì— ì•ì„œ ê¸°ì´ˆì ì¸ ë¶€ë¶„ ë‹¤ì‹œ ê³µë¶€í•´ì˜¤ê¸°
#### 9ì¼ì°¨
*
#### 10ì¼ì°¨
* Android UI ì‘ì—…
* DB ì„¤ê³„
#### 11ì¼ì°¨
* Android UI ì‘ì—…
* MariDB ì„¤ì¹˜
#### 12ì¼ì°¨
* Android UI ì‘ì—…
* DB Table ì„¤ê³„ ì „ ìš”êµ¬ì‚¬í•­ ë¶„ì„
#### 13ì¼ì°¨
* Database í…Œì´ë¸” ì„¤ê³„
* DB ê°œë… ê³µë¶€í•˜ê¸°

## í”„ë¡œì íŠ¸ ì‹œì‘ 

##### ğŸ–¥ï¸ Spring Code 

|Tool(IDE)|ê°œë°œ ë‚´ìš©|í‚¤ì›Œë“œ|
|------|---|---|
|STS|Spring jdbcë¥¼ ì´ìš©í•´ì„œ mariaDB(HeidiSQL)ê°’ JSon í˜•íƒœë¡œ ë¶ˆëŸ¬ì˜¤ê¸°|Spring STS gradle JDBC JSON|
|Android Studio|STSì™€ App ì—°ë™(ê³„íš)|.|
|MariaDB(HeidiSQL)|tableì„¤ê³„(ì§„í–‰ì¤‘)|í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­|

#### â¤ï¸í”¼ë“œë°±(DAO ì½”ë“œ, Controller ì½”ë“œ, @Configuration, MariaDB ì—°ê²°)

##### 1) DAO code

* ë‚´ ì½”ë“œ
  ```
  @Component
  public class UserDao {
	
	@Autowired
	private JdbcTemplate jdbcTemplate;
	
	public Map<String, Object> getName(int seq) throws Exception {
		String sql = "SELCET * FROM smart_home";
		return jdbcTemplate.queryForMap(sql);
	}
  }

  @Autowired
	  public void setDataSource(DataSource dataSource) {
	    this.jdbcTemplate = new JdbcTemplate(dataSource);
	  }
    ```
    
##### 2) Controller code

* ë‚´ ì½”ë“œ
  ```
  @Controller
  @RequiredArgsConstructor
  @RequestMapping(value="/test2")
  public class Test2Controller {

	@Autowired
	UserDao userdao;
	
	@RequestMapping(method={RequestMethod.GET, RequestMethod.POST})
	public @ResponseBody String isTest() {
		
		return "Test";
	}
	
	@RequestMapping(value="/checkNetwork", method={RequestMethod.GET, RequestMethod.POST})
	public @ResponseBody String checkNetwork() {
		
		return "Network Connection";
	}

	@RequestMapping(value="/checkUserDao", method={RequestMethod.GET, RequestMethod.POST})
	public @ResponseBody String checkNetwork() {
		
		return userdao.getName(0);
	}
  }
  ```
  
##### 3) @Configuration

* ë‚´ ì½”ë“œ
  ```
  package kr.co.geoplan.smarthome.config;

  import org.apache.commons.dbcp2.BasicDataSource;
  import org.springframework.boot.CommandLineRunner;
  import org.springframework.context.ApplicationContext;
  import org.springframework.context.annotation.Bean;
  import org.springframework.context.annotation.Configuration;
  import org.springframework.core.env.Environment;
  import org.springframework.jdbc.datasource.DataSourceTransactionManager;

  import lombok.AllArgsConstructor;

  @AllArgsConstructor
  @Configuration
  public class DBConfig {
	
	private final String DRIVER = "com.mariadb.jdbc.Driver";
	private final String URL = "geoplan.iptime.org";
	private String username = "****";
	private String password = "****";

	@Bean
	public DataSource dataSource() {
		BasicDataSource dataSource = new BasicDataSource();
		dataSource.setDriverClassName(DRIVER);
		dataSource.setUrl(URL);
		dataSource.setUsername(username);
		dataSource.setPassword(password);
		return dataSource;
	}
  }
  ```
  
#### JSON í˜•íƒœë¡œ ê²°ê³¼ ì¶œë ¥í•˜ê¸°
  
   ![Inkedjsoní˜•ì‹_LI](https://user-images.githubusercontent.com/52366841/127415006-4d83837b-5ce1-4aa1-bf13-72ef92993761.jpg)
   
#### ğŸ’™ Annotation

 Annotation(@)ì€ ì‚¬ì „ì  ì˜ë¯¸ë¡œëŠ” ì£¼ì„ì´ë¼ëŠ” ëœ»ì´ë‹¤.   
 ìë°”ì—ì„œ Annotationì€ ì½”ë“œ ì‚¬ì´ì— ì£¼ì„ì²˜ëŸ¼ ì“°ì´ë©° íŠ¹ë³„í•œ ì˜ë¯¸, ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ë„ë¡ í•˜ëŠ” ê¸°ìˆ ì´ë‹¤.   
 ì¦‰, í”„ë¡œê·¸ë¨ì—ê²Œ ì¶”ê°€ì ì¸ ì •ë³´ë¥¼ ì œê³µí•´ì£¼ëŠ” ë©”íƒ€ë°ì´í„°ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.   
 
 ğŸ¥‘ ìš©ë„
 
 * ì»´íŒŒì¼ëŸ¬ì—ê²Œ ì½”ë“œ ì‘ì„± ë¬¸ë²• ì—ëŸ¬ë¥¼ ì²´í¬í•˜ë„ë¡ ì •ë³´ë¥¼ ì œê³µí•œë‹¤.
 * ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ íˆ´ì´ ë¹Œë“œë‚˜ ë°°ì¹˜ì‹œ ì½”ë“œë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆë„ë¡ ì •ë³´ë¥¼ ì œê³µí•œë‹¤.
 * ì‹¤í–‰ì‹œ(ëŸ°íƒ€ì„ì‹œ) íŠ¹ì • ê¸°ëŠ¥ì„ ì‹¤í–‰í•˜ë„ë¡ ì •ë³´ë¥¼ ì œê³µí•œë‹¤.
 
 ğŸ‰ Annotation ì¢…ë¥˜
 
 #### @ComponentScan


  

* ì–´ë…¸í…Œì´ì…˜ @Autowired @Bean @Repository ê²€ìƒ‰í•´ë³´ê¸°
* ì˜¤ë¥˜í•´ê²°?  DAO ë¶ˆëŸ¬ì˜¤ëŠ” ë¶€ë¶„ UserDao userdao = new UserDao() x -> ì „ì—­ë³€ìˆ˜ë¡œ ë¹¼ê³  @Autowired ì–´ë…¸í…Œì´ì…˜ ì¶”ê°€ UserDao userdao; ìœ¼ë¡œ ìˆ˜ì •í•˜ë‹ˆê¹Œ Bean ì¸ì ì…˜ ì˜ ë¨
  (<a href="https://namubada.net/98">ì°¸ê³ </a>)
  
##### ğŸ–¥ï¸ Cookie & Spring Security
  
|Tool(IDE)|ê°œë°œ ë‚´ìš©|í‚¤ì›Œë“œ|
|------|---|---|
|Postman|Cookie ìƒì„±í•´ì„œ ë³´ì•ˆ ì¸ì¦ìš”ì²­ ì—†ì´ Controller ì ‘ê·¼í•˜ë„ë¡ í•˜ê¸°|Cookie Session Config Http|
|MariaDB(HeidiSQL)|LoginController ê°’ JSON í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì„œ DBì— ë¡œê·¸ì¸ ì •ë³´ ì €ì¥íˆê¸°|Controller Postman HeidiSQL UserDTO|

#### â¤ï¸í”¼ë“œë°±(Controller ì½”ë“œ, AuthenticationFilter ì½”ë“œ, Postman Cookie)

##### 1) Controller ì½”ë“œ

* ë‚´ ì½”ë“œ
  ```
  Map<String, Object> result = Maps.newHashMap();
		try	{
			LoginResult loginResult = userService.checkLogin(loginDTO);
			
			//ë¡œê·¸ì¸ SUCCESSì‹œ ì„¸ì…˜ìƒì„±
			if (loginResult == LoginResult.SUCCESS)
			{
				UserSessionDTO session = userService.makeSessionId(loginDTO.getEmail());
				
				Cookie cookie = new Cookie(Const.SESSION_KEY, session.getSessionId());
				res.addCookie(cookie);
			}
			
			//ë¡œê·¸ì¸ SUCCESSì™¸ ëŠ” ë¡œê·¸ì¸ê²°ê³¼ë¥¼ ì „ë‹¬ë§Œí•œë‹¤.
			result.put("data", loginResult);
		}
		catch (Exception e) {
			e.printStackTrace();
			result.put("error", "SERVER ERROR");
		}
		
		return result;
  ```
  
